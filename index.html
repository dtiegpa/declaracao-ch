<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Buscar Declaração</title>
</head>
<body>
  <h1>Buscar Declaração de Carga Horária</h1>
  <input type="text" id="nome" placeholder="Digite seu nome" />
  <button onclick="buscar()">Buscar</button>
  <p id="mensagem"></p>

  <script>
    async function buscar() {
      const nome = document.getElementById('nome').value.trim();
      const mensagem = document.getElementById('mensagem');
      mensagem.textContent = "Buscando...";

      if (!nome) {
        mensagem.textContent = "Digite um nome.";
        return;
      }

      try {
        const res = await fetch(`https://script.google.com/macros/s/AKfycbxnhFgy1uaVC_r422lN7QAoJlS6s9o_891FXJInM3miqIJvp6CKEJR74s8tFkbGIpjngQ/exec?nome=${encodeURIComponent(nome)}`);
        const data = await res.json();

        if (data.url) {
          mensagem.innerHTML = `<a href="${data.url}" target="_blank">Clique aqui para baixar seu certificado</a>`;
        } else {
          mensagem.textContent = data.erro || "Erro desconhecido.";
        }
      } catch (err) {
        mensagem.textContent = "Erro ao buscar o arquivo.";
      }
    }
  </script>
</body>
</html>
